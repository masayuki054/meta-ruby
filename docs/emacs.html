<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>2016 Emacs</title>
<!-- 2016-10-02 日 05:29 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="suzuki@cis.iwate-u.ac.jp" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://nat054.ddo.jp/~masayuki/org-html-theme/styles/sos/css/sos.css">
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/hideshow.css"/>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery-ui-1.10.2.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.localscroll-min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.scrollTo-1.4.3.1-min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.zclip.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/hideshow.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="http://nat054.ddo.jp/~masayuki/org-html-theme/styles/sos/js/hideshow.js"></script>
<script type="text/javascript" src="http://nat054.ddo.jp/~masayuki/org-html-theme/styles/sos/js/sos.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">2016 Emacs</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. おしらせ</a></li>
<li><a href="#sec-2">2. emacs</a>
<ul>
<li><a href="#sec-2-1">2.1. emacs-24.5</a></li>
<li><a href="#sec-2-2">2.2. emacsのパッケージと設定</a></li>
</ul>
</li>
<li><a href="#sec-3">3. package</a>
<ul>
<li><a href="#sec-3-1">3.1. emacs package について</a>
<ul>
<li><a href="#sec-3-1-1">設定</a></li>
<li><a href="#sec-3-1-2">利用方法</a></li>
<li><a href="#sec-3-1-3">管理例</a></li>
<li><a href="#sec-3-1-4">更新</a></li>
</ul>
</li>
<li><a href="#sec-3-2">3.2. emacsのruby環境をセットアップする</a></li>
<li><a href="#sec-3-3">3.3. ruby-mode,ruby-end,ruby-blockをインストール</a>
<ul>
<li><a href="#sec-3-3-1">packages</a></li>
<li><a href="#sec-3-3-2">設定</a></li>
</ul>
</li>
<li><a href="#sec-3-4">3.4. auto-completeのインストール</a>
<ul>
<li><a href="#sec-3-4-1">packages</a></li>
<li><a href="#sec-3-4-2">設定</a></li>
</ul>
</li>
<li><a href="#sec-3-5">3.5. robeのインストール</a>
<ul>
<li><a href="#sec-3-5-1">pryのインストール</a></li>
<li><a href="#sec-3-5-2">package</a></li>
<li><a href="#sec-3-5-3">設定</a></li>
<li><a href="#sec-3-5-4">robeの起動方法</a></li>
</ul>
</li>
<li><a href="#sec-3-6">3.6. rbenvのパスを通す</a>
<ul>
<li><a href="#sec-3-6-1">package</a></li>
<li><a href="#sec-3-6-2">設定</a></li>
</ul>
</li>
<li><a href="#sec-3-7">3.7. smart-newlineを導入する</a>
<ul>
<li><a href="#sec-3-7-1">package</a></li>
<li><a href="#sec-3-7-2">設定</a></li>
</ul>
</li>
<li><a href="#sec-3-8">3.8. Todo emacsの org-mode 環境をセットアップする</a></li>
</ul>
</li>
<li><a href="#sec-4">4. おまけ</a>
<ul>
<li><a href="#sec-4-1">4.1. recentf</a>
<ul>
<li><a href="#sec-4-1-1">emacs</a>
<ul>
<li><a href="#sec-4-1-1-1">emacs</a></li>
<li><a href="#sec-4-1-1-2">C-x r コマンド レジスタ関連</a></li>
<li><a href="#sec-4-1-1-3">Emacs24.4組み込みブラウザewwで目の疲れを1/10にする方法 | るびきち「日刊Emacs」</a></li>
<li><a href="#sec-4-1-1-4">Emacs での テキストブラウザ eww を使えるレベルにする</a></li>
<li><a href="#sec-4-1-1-5">eww-mode (eww.el) binding</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<p>
<a href="./">ホーム</a> /
<a href="./ruby.html">ruby</a> / 
<a href="./oo.html">OO</a> / 
<a href="./emacs.html">emacs</a> / 
<a href="./meta.html">meta</a> /
<a href="./note.html">note</a> /
<a href="http://wiki.cis.iwate-u.ac.jp/~suzuki/lects/meta-ruby/">2015</a>
</p>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> おしらせ</h2>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> emacs</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> emacs-24.5</h3>
<div class="outline-text-3" id="text-2-1">
<p>
emacs-24.5 を ~suzuki/local/ にインストールしました。
</p>
<ul class="org-ul">
<li>org-mode が 8系になっている。babel/tangle が改善されているような
気がします。
</li>
<li>emacs内で動く web ブラウザ eww が入っている。
</li>
</ul>

<p>
コマンド PATH の設定は下記です:
</p>
<div class="org-src-container">

<pre class="src src-sh">export PATH=~suzuki/local/bin:$PATH
</pre>
</div>
</div>
</div>



<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> emacsのパッケージと設定</h3>
<div class="outline-text-3" id="text-2-2">
<p>
emacs の設定などは，~suzuki/local/share/emacs/site-lisp/ に置きまし
た。 ~/.emacs.d/init.el に下記を追加してください:
</p>

<div class="org-src-container">

<pre class="src src-elisp">(load (expand-file-name "~suzuki/local/share/emacs/site-lisp/init.el"))
</pre>
</div>

<p>
~suzuki/local/share/emacs/site-lispの下にあるファイルは:
</p>
<dl class="org-dl">
<dt> init.el </dt><dd>パッケージの初期化と設定
</dd>
<dt> package-update.el </dt><dd>講義に必要なパッケージの更新
</dd>
<dt> init_loader/*.el </dt><dd>パッケージ毎の設定
</dd>
</dl>

<p>
init.elの中身です:        
</p>
<div class="org-src-container">

<pre class="src src-elisp">(load (expand-file-name "~suzuki/local/share/emacs/site-lisp/package-update.el"))
(unless (package-installed-p 'init-loader)
  (package-install 'init-loader))
(require 'init-loader)
(init-loader-load "~suzuki/local/share/emacs/site-lisp/init_loader")
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> package</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> emacs package について</h3>
<div class="outline-text-3" id="text-3-1">
<p>
<a href="http://emacs-jp.github.io/packages/package-management/package-el.html">package.el - Emacs JP</a> のまとめ
</p>
</div>

<div id="outline-container-sec-3-1-1" class="outline-4">
<h4 id="sec-3-1-1">設定</h4>
<div class="outline-text-4" id="text-3-1-1">
<div class="org-src-container">

<pre class="src src-elisp">(require 'package)

;; MELPAを追加
(add-to-list 'package-archives 
	     '("melpa" . "http://melpa.org/packages/") t)

;; MELPA-stableを追加
(add-to-list 'package-archives
	     '("melpa-stable" . "http://stable.melpa.org/packages/") t)

;; Marmaladeを追加
(add-to-list 'package-archives  
	     '("marmalade" . "http://marmalade-repo.org/packages/") t)

;; Orgを追加
(add-to-list 'package-archives 
	     '("org" . "http://orgmode.org/elpa/") t)

;; 初期化
(package-initialize)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-1-2" class="outline-4">
<h4 id="sec-3-1-2">利用方法</h4>
<div class="outline-text-4" id="text-3-1-2">
<pre class="example">
M-x package-install
</pre>

<p>
指定したパッケージをインストールする.
</p>

<pre class="example">
M-x package-refresh-contents
</pre>

<p>
パッケージ情報を更新する. 最新のものをインストールしたい場合は, 事
前に実行して置くと 良い. 後述の package-list-packagesからインストー
ルを行う場合は不要.
</p>

<pre class="example">
M-x package-list-packages
</pre>

<p>
パッケージ操作バッファを開く.
</p>
</div>
</div>

<div id="outline-container-sec-3-1-3" class="outline-4">
<h4 id="sec-3-1-3">管理例</h4>
<div class="outline-text-4" id="text-3-1-3">
<p>
(package-installed-p package-name)で package-nameがインストール済み
で あるかを確認することができるので, package-installed-pが nilを返
すパッケージを インストールすれば, 同じ環境を構築することができる.
</p>

<p>
以下のようなファイルを用意し, M-x eval-bufferを実行することで, イン
ストールされて いないパッケージをインストールすることができる.
</p>

<div class="org-src-container">

<pre class="src src-elisp">;; パッケージ情報の更新
(package-refresh-contents)

;; インストールするパッケージ
(defvar my/favorite-packages
  '(
    ;; for ruby
    ruby-end
    inf-ruby
    ruby-mode

    ;; for org-mode
    htmlize
    auto-complete
    fuzzy
    popup
    robe
    inf-ruby
    rbenv
    smart-newline

    recentf
    elscreen
    ))

;; my/favorite-packagesからインストールしていないパッケージをインストール

(dolist (package my/favorite-packages)
  (unless (package-installed-p package)
    (package-install package)))
</pre>
</div>


<p>
package-installed-p関数はあくまでインストールしているかどうかを 知らせるだけなので, アップグレードできるかどうかを検知できるわけではない.
</p>
</div>
</div>

<div id="outline-container-sec-3-1-4" class="outline-4">
<h4 id="sec-3-1-4">更新</h4>
<div class="outline-text-4" id="text-3-1-4">
<p>
package-list-packagesを実行し, U, xとすることで, インストール済みの パッ
ケージをすべて upgradeできる.
</p>
</div>
</div>
</div>


<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> emacsのruby環境をセットアップする</h3>
<div class="outline-text-3" id="text-3-2">
<p>
<a href="http://blog.10rane.com/2014/09/01/set-up-ruby-mode-of-emacs/">http://blog.10rane.com/2014/09/01/set-up-ruby-mode-of-emacs/</a>
</p>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> ruby-mode,ruby-end,ruby-blockをインストール</h3>
<div class="outline-text-3" id="text-3-3">
</div><div id="outline-container-sec-3-3-1" class="outline-4">
<h4 id="sec-3-3-1">packages</h4>
<div class="outline-text-4" id="text-3-3-1">
<ul class="org-ul">
<li>ruby-mode
</li>
<li>ruby-end
</li>
<li>ruby-block
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3-3-2" class="outline-4">
<h4 id="sec-3-3-2">設定</h4>
<div class="outline-text-4" id="text-3-3-2">
<div class="org-src-container">

<pre class="src src-elisp">;; --------------------------------------------------
;; ruby-mode
;; http://shibayu36.hatenablog.com/entry/2013/03/18/192651
;; --------------------------------------------------
(autoload 'ruby-mode "ruby-mode"
  "Mode for editing ruby source files" t)
(add-to-list 'auto-mode-alist '("\\.rb$" . ruby-mode))
(add-to-list 'auto-mode-alist '("Capfile$" . ruby-mode))
(add-to-list 'auto-mode-alist '("Gemfile$" . ruby-mode))
;; shebangがrubyの場合、ruby-modeを開く
(add-to-list 'interpreter-mode-alist '("ruby" . ruby-mode)) 

;; ruby-modeのインデントを改良する
(setq ruby-deep-indent-paren-style nil)
(defadvice ruby-indent-line (after unindent-closing-paren activate)
  (let ((column (current-column))
	indent offset)
    (save-excursion
      (back-to-indentation)
      (let ((state (syntax-ppss)))
	(setq offset (- column (current-column)))
	(when (and (eq (char-after) ?\))
		   (not (zerop (car state))))
	  (goto-char (cadr state))
	  (setq indent (current-indentation)))))
    (when indent
      (indent-line-to indent)
      (when (&gt; offset 0) (forward-char offset)))))


;; --------------------------------------------------
;; ruby-end
;; endや括弧などを自動挿入する
;; http://blog.livedoor.jp/ooboofo3/archives/53748087.html
;; --------------------------------------------------
(require 'ruby-end)
(add-hook 'ruby-mode-hook
  '(lambda ()
    (abbrev-mode 1)
    (electric-pair-mode t)
    (electric-indent-mode t)
    (electric-layout-mode t)))

;; --------------------------------------------------
;; ruby-block
;; endにカーソルを合わせると、そのendに対応する行をハイライトする
;; --------------------------------------------------
(require 'ruby-block)
(ruby-block-mode t)
(setq ruby-block-highlight-toggle t)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4"><span class="section-number-3">3.4</span> auto-completeのインストール</h3>
<div class="outline-text-3" id="text-3-4">
</div><div id="outline-container-sec-3-4-1" class="outline-4">
<h4 id="sec-3-4-1">packages</h4>
<div class="outline-text-4" id="text-3-4-1">
<ul class="org-ul">
<li>auto-complete
</li>
<li>fuzzy
</li>
<li>popup
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3-4-2" class="outline-4">
<h4 id="sec-3-4-2">設定</h4>
<div class="outline-text-4" id="text-3-4-2">
<div class="org-src-container">

<pre class="src src-elisp">(require 'auto-complete-config)
(add-to-list 'ac-dictionary-directories "~/.emacs.d/.cask/24.3.1/elpa/auto-complete-20140824.1658/dict")
(ac-config-default)
(setq ac-use-menu-map t)
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-5" class="outline-3">
<h3 id="sec-3-5"><span class="section-number-3">3.5</span> robeのインストール</h3>
<div class="outline-text-3" id="text-3-5">
</div><div id="outline-container-sec-3-5-1" class="outline-4">
<h4 id="sec-3-5-1">pryのインストール</h4>
<div class="outline-text-4" id="text-3-5-1">
<div class="org-src-container">

<pre class="src src-sh">gem install pry pry-doc bundler
source ~/.bashrc
which pry
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-5-2" class="outline-4">
<h4 id="sec-3-5-2">package</h4>
<div class="outline-text-4" id="text-3-5-2">
<ul class="org-ul">
<li>robe
</li>
<li>inf-ruby
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3-5-3" class="outline-4">
<h4 id="sec-3-5-3">設定</h4>
<div class="outline-text-4" id="text-3-5-3">
<div class="org-src-container">

<pre class="src src-elisp">;; --------------------------------------------------
;; robe
;; http://codeout.hatenablog.com/entry/2014/02/04/210237
;; --------------------------------------------------
(add-hook 'ruby-mode-hook 'robe-mode)
(autoload 'robe-mode "robe" "Code navigation, documentation lookup and completion for Ruby" t nil)
(autoload 'ac-robe-setup "ac-robe" "auto-complete robe" nil nil)
(add-hook 'robe-mode-hook 'ac-robe-setup)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-5-4" class="outline-4">
<h4 id="sec-3-5-4">robeの起動方法</h4>
<div class="outline-text-4" id="text-3-5-4">
<p>
robeを利用するには、
</p>

<div class="org-src-container">

<pre class="src src-emacs">M-x inf-ruby   ;; を実行し、裏でirb(pry)を起動させ、
M-x robe-start ;; で初めてrobeが使えるようになります。
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-6" class="outline-3">
<h3 id="sec-3-6"><span class="section-number-3">3.6</span> rbenvのパスを通す</h3>
<div class="outline-text-3" id="text-3-6">
<p>
Emacs の中で，rbenvのパスを通してくれます。
</p>
</div>

<div id="outline-container-sec-3-6-1" class="outline-4">
<h4 id="sec-3-6-1">package</h4>
<div class="outline-text-4" id="text-3-6-1">
<ul class="org-ul">
<li>rbenv
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3-6-2" class="outline-4">
<h4 id="sec-3-6-2">設定</h4>
<div class="outline-text-4" id="text-3-6-2">
<div class="org-src-container">

<pre class="src src-elisp">(require 'rbenv)
(global-rbenv-mode)
(setq rbenv-installation-dir "~/.rbenv")
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-7" class="outline-3">
<h3 id="sec-3-7"><span class="section-number-3">3.7</span> smart-newlineを導入する</h3>
<div class="outline-text-3" id="text-3-7">
<p>
改行をよしなにやってくれます。素敵です。
</p>
</div>

<div id="outline-container-sec-3-7-1" class="outline-4">
<h4 id="sec-3-7-1">package</h4>
<div class="outline-text-4" id="text-3-7-1">
<ul class="org-ul">
<li>smart-newline
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3-7-2" class="outline-4">
<h4 id="sec-3-7-2">設定</h4>
<div class="outline-text-4" id="text-3-7-2">
<div class="org-src-container">

<pre class="src src-elisp">(add-hook 'ruby-mode-hook
  (lambda ()
  (smart-newline-mode t)))
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-3-8" class="outline-3">
<h3 id="sec-3-8"><span class="section-number-3">3.8</span> Todo emacsの org-mode 環境をセットアップする</h3>
<div class="outline-text-3" id="text-3-8">
<div class="org-src-container">

<pre class="src src-elisp">(require 'org)
(require 'org-compat)
(require 'org-list)

;; キーバインドの設定
(define-key global-map "\C-cl" 'org-store-link)
(define-key global-map "\C-ca" 'org-agenda)

;; 拡張子がorgのファイルを開いた時，自動的にorg-modeにする
(add-to-list 'auto-mode-alist '("\\.org$" . org-mode))

;; org-modeでの強調表示を可能にする
(add-hook 'org-mode-hook 'turn-on-font-lock)

;; 見出しの余分な*を消す
(setq org-hide-leading-stars t)

;; org-default-notes-fileのディレクトリ
;;(setq org-directory "~/org/")

;; org-default-notes-fileのファイル名
;;(setq org-default-notes-file "notes.org")

;; TODO状態
(setq org-todo-keywords
      '((sequence "Todo(t)" "Quest(?)" "Sched(@)" "Search(/)" "Doing(i)" "Waiting(w)" "|" "Done(d)" "Someday(s)" "Cancel(c)")))

;; DONEの時刻を記録
(setq org-log-done 'time)

;; アジェンダ表示の対象ファイル
(setq org-agenda-files (list org-directory))

;; アジェンダ表示で下線を用いる
(add-hook 'org-agenda-mode-hok '(lambda () (hl-line-mode 1)))
(setq hl-line-face 'uderline)

;; tags
(setq org-tag-alist
      '(;; where
	("@UNIV" . ?u) ("@HOME" . ?h) 
	;; do
	("BUY" . ?b) ("MAIL". ?m) 
	;; what to use
	("PROJECT" . ?p) ("LECT" . ?l) ("SEMI" . ?z)))

(defun org-insert-upheading (arg)
  (interactive "p")
  (org-insert-heading arg)
  (cond ((org-on-heading-p) (org-do-promote))
	((org-at-item-p) (org-indent-item -1))))

(defun org-insert-heading-dwim (arg)
  (interactive "p")
  (case arg
    (4 (org-insert-subheading nil))
    (16 (org-insert-upheading nil))
    (t (org-insert-heading nil))))

(define-key org-mode-map
  (kbd "&lt;C-return&gt;") 'org-insert-heading-dwim)

;; latex export setting

(setq org-export-latex-coding-system 'utf-8-unix)
(setq org-export-latex-date-format "%Y-%m-%d")
(setq org-export-latex-classes nil)
(add-to-list 'org-export-latex-classes
	     '("jarticle"
	       "\\documentclass[a4j]{jarticle}"
	       ("\\section{%s}" . "\\section*{%s}")
	       ("\\subsection{%s}" . "\\subsection*{%s}")
	       ("\\subsubsection{%s}" . "\\subsubsection*{%s}")
	       ("\\paragraph{%s}" . "\\paragraph*{%s}")
	       ("\\subparagraph{%s}" . "\\subparagraph*{%s}")
	       ))

(add-to-list 'org-export-latex-classes
	     '("article"
	       "\\documentclass[a4j]{jarticle}"
	       ("\\section{%s}" . "\\section*{%s}")
	       ("\\subsection{%s}" . "\\subsection*{%s}")
	       ("\\subsubsection{%s}" . "\\subsubsection*{%s}")
	       ("\\paragraph{%s}" . "\\paragraph*{%s}")
	       ("\\subparagraph{%s}" . "\\subparagraph*{%s}")
	       ))

(setq org-export-latex-hyperref-format "\\ref{%s}")

(setq org-beamer-sectioning
      '(
	("\\section{%s}" . "\\section*{%s}")
	("\\subsection{%s}" . "\\subsection*{%s}")
	("\\subsubsection{%s}" . "\\subsubsection*{%s}")
	("\\paragraph{%s}" . "\\paragraph*{%s}")
	("\\subparagraph{%s}" . "\\subparagraph*{%s}")))

(add-to-list 'org-export-latex-classes
	     `("beamer"
	       "\\documentclass[compress,dvipdfm]{beamer}"
	       ,@org-beamer-sectioning))


(global-set-key "\C-c L" 'org-insert-link-global)
(global-set-key "\C-c o" 'org-open-at-point-global)


(require 'org-install)
(setq org-startup-truncated nil)
(setq org-return-follows-link t)
(add-to-list 'auto-mode-alist '("\\.org$" . org-mode))
(setq org-directory "~/howm/org/")
(setq org-default-notes-file (concat org-directory "CAPTURE.org"))
(setq org-capture-templates
      '(("t" "Todo" entry
	 (file+headline nil "Inbox")
	 "** TODO %?\n   %i\n   %a\n   %t")
	("b" "Bug" entry
	 (file+headline nil "Inbox")
	 "** TODO %?   :bug:\n   %i\n   %a\n   %t")
	("i" "Idea" entry
	 (file+headline nil "New Ideas")
	 "** %?\n   %i\n   %a\n   %t")))

(global-set-key (kbd "C-c c") 'org-capture)

(setq org-capture-templates
      '(("a" "ふつうのエントリー後に追加" entry
	 (file+headline nil "entry")
	 "* %?\n%U\n%a\n")
	("b" "ふつうのエントリー前に追加" entry
	 (file+headline nil "entry")
	 "* %?\n%U\n%a\n" :prepend t)
	("c" "即座に書き込み" entry
	 (file+headline nil "entry")
	 "* immediate-finish\n" :immediate-finish t)
	("d" "ナローイングしない" entry
	 (file+headline nil "entry")
	 "* 全体を見る\n\n" :unnarrowed t)
	("e" "クロック中のエントリに追加" entry (clock)
	 "* clocking" :unnarrowed t)
	("f" "リスト" item
	 (file+headline nil "list")
	 "- リスト")
	;; うまく動かない
	("g" "チェックリスト" checkitem
	 (file+headline nil "list")
	 "チェックリスト")
	("h" "表の行" table-line
	 (file+headline nil "table")
	 "|表|")
	("i" "そのまま" plain
	 (file+headline nil "plain")
	 "あいうえお")
	("j" "ノードをフルパス指定して挿入" entry
	 (file+olp nil "test" "entry")
	 "* %?\n%U\n%a\n")
	;; これもうまく動かない
	("k" "ノードを正規表現指定して挿入" entry
	 (file+regexp nil "list")
	 "* %?\n%U\n%a\n")
	;; 年月日エントリは追記される
	("l" "年/月/日のエントリを作成する1" entry
	 (file+datetree nil))
	("m" "年/月/日のエントリを作成する2" item
	 (file+datetree nil))
	("o" "年/月/日のエントリを作成する prepend" entry
	 (file+datetree nil) "* a" :prepend t)))


;; (require 'ox-freemind)

(defun org-font-lock-ensure ()
  (font-lock-fontify-buffer))

;;(setq org-doing-file "~/howm/org/doing.org")

;; babel, makefile 中のtabをexpandしないように
(setq org-src-preserve-indentation t)

(org-babel-do-load-languages
 'org-babel-load-languages
 '((R . t)
   (emacs-lisp . t)
   (ruby . t)
   (dot . t)
   (ditaa . t)
   (sh . t)))

; Enable literal links 
(defun org-turn-on-literal-links ()
  "enable literal links."
  (interactive)
  (org-remove-from-invisibility-spec '(org-link))
  (org-restart-font-lock))

(defun org-turn-off-literal-links ()
  "disable literal links."
  (interactive)
  (setq buffer-invisibility-spec
	(cons '(org-link) buffer-invisibility-spec))
  (org-restart-font-lock))

;; (add-hook 'org-mode-hook 'org-turn-on-literal-links)
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> おまけ</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> recentf</h3>
<div class="outline-text-3" id="text-4-1">
<p>
~/.emacs.d/.recentf に最近使ったfile一覧を保存し、
M-x recentf-open-file で使う
</p>

<p>
helm と組合せると検索もできて便利
</p>

<div class="org-src-container">

<pre class="src src-elisp">;; recentf and recentf-ext.el
;; http://keisanbutsuriya.hateblo.jp/entry/2015/02/15/174758

(require 'recentf)
(setq recentf-save-file (expand-file-name "~/.emacs.d/.recentf"))
(setq recentf-max-saved-items 100)            ;; recentf に保存するファイルの数
(setq recentf-exclude '(".recentf"))           ;; .recentf自体は含まない
(setq recentf-auto-cleanup 10)                 ;; 保存する内容を整理
(run-with-idle-timer 30 t 'recentf-save-list)  ;; 30秒
(recentf-mode 1)
</pre>
</div>
</div>
<div id="outline-container-sec-4-1-1" class="outline-4">
<h4 id="sec-4-1-1">emacs</h4>
<div class="outline-text-4" id="text-4-1-1">
</div><div id="outline-container-sec-4-1-1-1" class="outline-5">
<h5 id="sec-4-1-1-1">emacs</h5>
<div class="outline-text-5" id="text-4-1-1-1">
<pre class="example">
C-x SPC (rectangle-mark-mode &amp;optional ARG) 
M-q 整形
C-x r x register 
C-x r g register 
C-x n n narrow region
C-x n w widen regions
M-x string-insert-rectangle
</pre>
</div>
</div>

<div id="outline-container-sec-4-1-1-2" class="outline-5">
<h5 id="sec-4-1-1-2">C-x r コマンド レジスタ関連</h5>
<div class="outline-text-5" id="text-4-1-1-2">
<pre class="example">
C-x r C-@     point-to-register
C-x r ESC     Prefix Command
C-x r SPC     point-to-register
C-x r +               increment-register
C-x r N               rectangle-number-lines
C-x r b               bookmark-jump
C-x r c               clear-rectangle
C-x r d               delete-rectangle
C-x r f               frameset-to-register
C-x r g               insert-register
C-x r i               insert-register
C-x r j               jump-to-register
C-x r k               kill-rectangle
C-x r l               bookmark-bmenu-list
C-x r m               bookmark-set
C-x r n               number-to-register
C-x r o               open-rectangle
C-x r r               copy-rectangle-to-register
C-x r s               copy-to-register
C-x r t               string-rectangle
C-x r w               window-configuration-to-register
C-x r x               copy-to-register
C-x r y               yank-rectangle
C-x r C-SPC   point-to-register

C-x r M-w     copy-rectangle-as-kill
</pre>
</div>
</div>


<div id="outline-container-sec-4-1-1-3" class="outline-5">
<h5 id="sec-4-1-1-3">Emacs24.4組み込みブラウザewwで目の疲れを1/10にする方法 | るびきち「日刊Emacs」</h5>
<div class="outline-text-5" id="text-4-1-1-3">
<p>
<a href="http://rubikitch.com/2014/11/19/eww-nocolor/">http://rubikitch.com/2014/11/19/eww-nocolor/</a>
</p>
</div>
</div>

<div id="outline-container-sec-4-1-1-4" class="outline-5">
<h5 id="sec-4-1-1-4">Emacs での テキストブラウザ eww を使えるレベルにする</h5>
<div class="outline-text-5" id="text-4-1-1-4">
<p>
<a href="http://futurismo.biz/archives/2950">http://futurismo.biz/archives/2950</a>
</p>

<p>
KeyBindings
</p>

<p>
N (eww-next-url)
P (eww-previous-url)
l (eww-back-url)
r (eww-forward-url)
H (eww-list-histories)
&amp; (eww-browse-with-external-browser)
b (eww-add-bookmark)
B (eww-list-bookmarks)
q (quit-window)
見にくいときは, R eww-readable
</p>
</div>
</div>


<div id="outline-container-sec-4-1-1-5" class="outline-5">
<h5 id="sec-4-1-1-5">eww-mode (eww.el) binding</h5>
<div class="outline-text-5" id="text-4-1-1-5">
<pre class="example">
key             binding
---             -------

ESC             Prefix Command
SPC             scroll-up-command
&amp;               eww-browse-with-external-browser
-               negative-argument
0 .. 9          digit-argument
B               eww-list-bookmarks
C               url-cookie-list
H               eww-list-histories
b               eww-add-bookmark
d               eww-download
g               eww-reload
l               eww-back-url
n               eww-next-url
p               eww-previous-url
q               quit-window
r               eww-forward-url
t               eww-top-url
u               eww-up-url
  (that binding is currently shadowed by another mode)
v               eww-view-source
  (that binding is currently shadowed by another mode)
w               eww-copy-page-url
  (that binding is currently shadowed by another mode)
DEL             scroll-down-command
S-SPC           scroll-down-command
&lt;delete&gt;        scroll-down-command
&lt;remap&gt;         Prefix Command

M-n             eww-next-bookmark
M-p             eww-previous-bookmark
</pre>

<p>
This mode runs the hook `eww-mode-hook', as the final step during
initialization.
</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: suzuki@cis.iwate-u.ac.jp</p>
<p class="date">Created: 2016-10-02 日 05:29</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.5.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
