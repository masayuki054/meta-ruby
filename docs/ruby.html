<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"https://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="https://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>2016 Ruby</title>
<!-- 2016-10-02 日 21:54 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="suzuki@cis.iwate-u.ac.jp" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://nat054.ddo.jp/~masayuki/org-html-theme/styles/sos/css/sos.css">
<link rel="stylesheet" type="text/css" href="https://www.pirilampo.org/styles/bigblow/css/hideshow.css"/>
<script type="text/javascript" src="https://www.pirilampo.org/styles/bigblow/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/bigblow/js/jquery-ui-1.10.2.min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/bigblow/js/jquery.localscroll-min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/bigblow/js/jquery.scrollTo-1.4.3.1-min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/bigblow/js/jquery.zclip.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/bigblow/js/hideshow.js"></script>
<script type="text/javascript" src="https://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://nat054.ddo.jp/~masayuki/org-html-theme/styles/sos/js/hideshow.js"></script>
<script type="text/javascript" src="https://nat054.ddo.jp/~masayuki/org-html-theme/styles/sos/js/sos.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">2016 Ruby</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. ruby 情報</a>
<ul>
<li><a href="#sec-1-1">1.1. ruby の情報</a></li>
<li><a href="#sec-1-2">1.2. manual</a></li>
</ul>
</li>
<li><a href="#sec-2">2. ruby入門</a>
<ul>
<li><a href="#sec-2-1">2.1. 2016</a></li>
<li><a href="#sec-2-2">2.2. 2015</a>
<ul>
<li><a href="#sec-2-2-1">内容  <code>[1/10]</code></a></li>
</ul>
</li>
<li><a href="#sec-2-3">2.3. その他の入門</a></li>
</ul>
</li>
<li><a href="#sec-3">3. ruby 環境作り</a>
<ul>
<li><a href="#sec-3-1">3.1. rbenv/gem/bundler</a>
<ul>
<li><a href="#sec-3-1-1">rbenv</a></li>
<li><a href="#sec-3-1-2">rubyのインストール</a></li>
<li><a href="#sec-3-1-3">gem &#x2013; ruby のパッケージ管理</a></li>
<li><a href="#sec-3-1-4">bundler</a></li>
</ul>
</li>
<li><a href="#sec-3-2">3.2. pry</a></li>
</ul>
</li>
<li><a href="#sec-4">4. ruby におけるプログラムの実行のまとめ</a>
<ul>
<li><a href="#sec-4-1">4.1. プログラム</a>
<ul>
<li><a href="#sec-4-1-1">self とクラス</a></li>
<li><a href="#sec-4-1-2">リテラル</a></li>
<li><a href="#sec-4-1-3">変数</a></li>
<li><a href="#sec-4-1-4">メッセージパッシング式</a></li>
<li><a href="#sec-4-1-5">メソッドとクラス</a></li>
<li><a href="#sec-4-1-6">文と制御</a></li>
<li><a href="#sec-4-1-7">スコープの切り替え</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-5">5. rubyあれこれ</a>
<ul>
<li><a href="#sec-5-1">5.1. オブジェクトとメソッド呼び出し</a></li>
<li><a href="#sec-5-2">5.2. String.newで起こること</a></li>
<li><a href="#sec-5-3">5.3. オブジェクトとクラスとモジュール</a>
<ul>
<li><a href="#sec-5-3-1">オブジェクト</a></li>
<li><a href="#sec-5-3-2">モジュール &lt; オブジェクト</a></li>
<li><a href="#sec-5-3-3">クラス &lt; モジュール</a></li>
</ul>
</li>
<li><a href="#sec-5-4">5.4. クロージャ</a></li>
<li><a href="#sec-5-5">5.5. フレーム</a></li>
</ul>
</li>
<li><a href="#sec-6">6. rubyは生産性が高い？</a>
<ul>
<li><a href="#sec-6-1">6.1. 語彙 メタプログラミング</a></li>
</ul>
</li>
<li><a href="#sec-7">7. pry</a>
<ul>
<li><a href="#sec-7-1">7.1. what is pry?</a></li>
<li><a href="#sec-7-2">7.2. Rubyistよ、irbを捨ててPryを使おう</a>
<ul>
<li><a href="#sec-7-2-1">起動</a></li>
<li><a href="#sec-7-2-2">shellとの統合</a></li>
<li><a href="#sec-7-2-3">組み込みコマンド</a></li>
<li><a href="#sec-7-2-4">オブジェクトを調査する</a></li>
<li><a href="#sec-7-2-5">簡易デバッガとして使う</a></li>
</ul>
</li>
<li><a href="#sec-7-3">7.3. ドキュメントに素早く参照できる</a>
<ul>
<li><a href="#sec-7-3-1">gemやCの実装も読める</a></li>
</ul>
</li>
<li><a href="#sec-7-4">7.4. </a>
<ul>
<li><a href="#sec-7-4-1">ls - change scope</a></li>
<li><a href="#sec-7-4-2">find-method</a></li>
<li><a href="#sec-7-4-3">nesting &#x2013; seeing the nested context</a></li>
<li><a href="#sec-7-4-4">jump-to</a></li>
<li><a href="#sec-7-4-5">switch-to</a></li>
</ul>
</li>
<li><a href="#sec-7-5">7.5. 今更聞けないpryの使い方と便利プラグイン集</a>
<ul>
<li><a href="#sec-7-5-1">info</a></li>
<li><a href="#sec-7-5-2">最低限の使い方</a>
<ul>
<li><a href="#sec-7-5-2-1">binding.pryで任意の場所からREPLを立ち上げる</a></li>
</ul>
</li>
<li><a href="#sec-7-5-3">pry標準の機能</a>
<ul>
<li><a href="#sec-7-5-3-1">?, show-doc, ri, $, show-method</a></li>
<li><a href="#sec-7-5-3-2">edit</a></li>
<li><a href="#sec-7-5-3-3">cd, ls, Tab補完</a></li>
<li><a href="#sec-7-5-3-4">exit!, !!!, exit-program, disable-pry, edit -m</a></li>
<li><a href="#sec-7-5-3-5">.とshell-mode</a></li>
<li><a href="#sec-7-5-3-6">help</a></li>
</ul>
</li>
<li><a href="#sec-7-5-4">便利なプラグイン (pry関連プラグイン)</a>
<ul>
<li><a href="#sec-7-5-4-1">pry-byebug</a></li>
<li><a href="#sec-7-5-4-2">pry-stack_explorer</a></li>
<li><a href="#sec-7-5-4-3">pry-rails</a>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#sec-7-5-4-3-0-0-1">show-routes</a></li>
<li><a href="#sec-7-5-4-3-0-0-2">show-model, show-models</a></li>
<li><a href="#sec-7-5-4-3-0-0-3">reload!</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<p>
<a href="./">ホーム</a> /
<a href="./lects.html">講義</a> /
<a href="./ruby.html">ruby</a> / 
<a href="./oo.html">OO</a> / 
<a href="./emacs.html">emacs</a> / 
<a href="./meta-ruby.html">meta-ruby</a> /
<a href="./note.html">note</a> /
<a href="https://wiki.cis.iwate-u.ac.jp/~suzuki/lects/meta-ruby/">2015</a>
</p>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> ruby 情報</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> ruby の情報</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li><a href="https://magazine.rubyist.net/?0050">Rubyist Magazine - Rubyist Magazine 0050 号</a>
</li>

<li><a href="https://magazine.rubyist.net/?FirstStepRuby">Rubyist Magazine - Ruby の歩き方</a>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> manual</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li><a href="https://docs.ruby-lang.org/ja/2.0.0/doc/index.html">オブジェクト指向スクリプト言語 Ruby リファレンスマニュアル (Ruby 2.0.0)</a>
</li>

<li><a href="https://docs.ruby-lang.org/ja/search/">最速Rubyリファレンスマニュアル検索！ | るりまサーチ</a>
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> ruby入門</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> 2016</h3>
<div class="outline-text-3" id="text-2-1">
<p>
初回に，
<a href="https://www.ruby-lang.org/ja/documentation/quickstart/">20分ではじめるRuby</a>
を先ず読み，やってみましょう。
</p>

<p>
次に，2~3回かけて，<a href="https://www.tohoho-web.com/ruby/">とほほのRuby入門</a> をやり
ましょう。
</p>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> 2015</h3>
<div class="outline-text-3" id="text-2-2">
<p>
<a href="https://libro.tuyano.com/index2?id=953003">ビギナーのためのRubyプログラミング入門</a> をやりましょう
</p>

<ul class="org-ul">
<li><a href="https://wiki.cis.iwate-u.ac.jp/~suzuki/lects/meta-ruby/lects/ruby-begin-note.html">ビギナーのためのRubyプログラミング入門のノート</a> ((<a href="file:///users/home/masayuki/COMM/Lects/meta-ruby/git/org/~suzuki/lects/meta-ruby/lects/ruby-begin-note.html">@cis.org</a> <a href="file:///users/home/masayuki/COMM/Lects/meta-ruby/site/lects/ruby-begin-note.html">@s.org</a>))
</li>
</ul>
</div>

<div id="outline-container-sec-2-2-1" class="outline-4">
<h4 id="sec-2-2-1">内容  <code>[1/10]</code></h4>
<div class="outline-text-4" id="text-2-2-1">
<ol class="org-ol">
<li><code>[X]</code> Rubyを使ってみよう!

<ul class="org-ul">
<li><a href="https://docs.ruby-lang.org/ja/2.0.0/doc/spec=2fintro.html">はじめに (Ruby 2.0.0)</a>
</li>
<li><a href="https://docs.ruby-lang.org/ja/2.0.0/doc/spec=2feval.html">Ruby プログラムの実行 (Ruby 2.0.0)</a>
</li>
<li><a href="https://docs.ruby-lang.org/ja/2.0.0/doc/spec=2fcommands.html">コマンド (Ruby 2.0.0)</a>
</li>
<li><a href="https://docs.ruby-lang.org/ja/2.0.0/doc/spec=2frubycmd.html">Rubyの起動 (Ruby 2.0.0)</a>
</li>
</ul>
<p>
まずは、Rubyをインストールして利用できるようにしてみましょう。そし
て実際にRubyのスクリプトを動かすところまでやってみましょう。
</p>
</li>

<li><code>[&#xa0;]</code> 基本的な構文を覚えよう <a href="https://docs.ruby-lang.org/ja/2.0.0/doc/spec=2fcontrol.html">制御構造 (Ruby 2.0.0)</a>

<p>
プログラミング言語には、プログラムの流れを制御するための構文が用意
されています。基本的な構文の使い方をまとめて覚えましょう。
</p>
</li>

<li><code>[&#xa0;]</code> <a href="https://libro.tuyano.com/index3?id=959004">配列とハッシュ:ビギナーのためのRubyプログラミング入門</a>  

<p>
多数の値をまとめて管理するのが「配列」です。この配列の値を名前で管
理できるようにしたものが「ハッシュ（連想配列）」です。これらの基本
的な使い方について説明します。
</p>
</li>

<li><code>[&#xa0;]</code> 構造化からオブジェクトへ！

<p>
Rubyでは、スクリプトを整理し、構造的にまとめていくための仕組みが用
意されています。これは、突き詰めれば、プログラムを「オブジェクト」
というものとして作成する考え方へとつながっていきます。この「オブジェ
クト」に至るまでの考え方についてここで説明していきましょう。
</p>
</li>

<li><code>[&#xa0;]</code> オブジェクトを更に極める！

<p>
オブジェクトというものの働きや使い方を知ることは、Rubyを使い込んで
いくためには避けて通れない道です。今回も更にオブジェクトというもの
について説明を続けて行きましょう。今回のキーワードは「アクセサ」
「クラスメソッド」「継承」といったものです。
</p>
</li>

<li><code>[&#xa0;]</code> 日時とTimeクラス

<p>
日時を扱うために用意されているのが「Time」というクラスです。このク
ラスには、日時の表現はもちろん、日時を使った計算やさまざまなフォー
マットによる出力などのメソッドが一通り揃っています。これらの基本的
な使い方についてマスターしましょう。
</p>
</li>

<li><code>[&#xa0;]</code> テキスト（Stringクラス）の基本操作

<p>
テキストの値を扱う「String」クラスには、テキスト操作のためのさまざ
まなメソッドが用意されています。それらの中から主なものをピックアッ
プして使い方を説明しましょう。
</p>
</li>

<li><code>[&#xa0;]</code> テキストファイルのアクセス

<p>
Rubyでは、テキストファイルに簡単にアクセスすることができます。テキ
ストファイル利用の基本を覚えて、データの読み書きの基本について説明
をしましょう。
</p>
</li>

<li><code>[&#xa0;]</code> CSVファイル・アクセス

<p>
CSVファイルは、データベースなどの多数の値からなるデータを保存するの
に用いられるテキストファイルです。Rubyには、これを利用するための専
用機能がいろいろと用意されています。CSVの利用をマスターしてデータ管
理を行いましょう。
</p>
</li>

<li><code>[&#xa0;]</code> ERBによるWebアプリケーション開発

<p>
Rubyには「ERB」と呼ばれる、HTMLの中にRubyのスクリプトを埋め込んで実
 行する技術があります。これを使えば、簡単にRubyを使ったWebアプリケー
 ションが作れるのです。その基本的な使い方を覚えましょう。
</p>
</li>
</ol>
</div>
</div>
</div>






<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> その他の入門</h3>
<div class="outline-text-3" id="text-2-3">
<p>
てっとり早く全貌を掴むには，
</p>
<ul class="org-ul">
<li><a href="https://loveruby.net/ja/rhg/book/minimum.html">RHG「第1章 Ruby言語ミニマム</a>
</li>
</ul>

<p>
プログラミングしながら
</p>

<ul class="org-ul">
<li><a href="https://www.minituku.net/courses/1049510743/lessons/763190848/drills/282479059?locale=ja">ミニツク - Rubyのe-ラーニング研修システム</a>
</li>
<li><a href="https://dotinstall.com/lessons/basic_ruby_v2">Ruby入門 (全23回) - プログラミングならドットインストール</a>
     一話2〜3分でまあ聴きやすい
</li>
<li>rubymonk
</li>
<li>若手エンジニア／初心者のためのRuby 2.1入門 最新記事一覧 - ITmedia Keywords
<a href="https://www.atmarkit.co.jp/ait/kw/ruby_nyumon.html">https://www.atmarkit.co.jp/ait/kw/ruby_nyumon.html</a>
</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> ruby 環境作り</h2>
<div class="outline-text-2" id="text-3">
<p>
自分用の ruby の環境を作りましょう。
</p>

<p>
ruby のための emacs の設定については，<a href="https://wiki.cis.iwate-u.ac.jp/~suzuki/lects/meta-ruby/org-docs/emacs-setup.html">emacsの設定</a> ((<a href="file:///users/home/masayuki/COMM/Lects/meta-ruby/git/org/~suzuki/lects/meta-ruby/org-docs/emacs-setup.html">@cis.org</a> <a href="file:///users/home/masayuki/COMM/Lects/meta-ruby/site/org-docs/emacs-setup.html">@s.org</a>))
</p>
</div>

<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> rbenv/gem/bundler</h3>
<div class="outline-text-3" id="text-3-1">
</div><div id="outline-container-sec-3-1-1" class="outline-4">
<h4 id="sec-3-1-1">rbenv</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
<a href="https://d.hatena.ne.jp/zariganitosh/20141101/what_does_rbenv">rbenvは何をしているのか？ - ザリガニが見ていた&#x2026;。</a>
</p>

<ul class="org-ul">
<li>個人毎に用意できる ruby の環境 
</li>
<li>~/.rbenv/ の配下にバージョンごとに
</li>
<li>~/.rbenv/shims/ の配下にえらんだバージョンのバイナリへのリンクが
ある
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-1-2" class="outline-4">
<h4 id="sec-3-1-2">rubyのインストール</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
<a href="https://www.task-notes.com/entry/20140707/1404744444">Ruby開発環境の準備+rbenvの使い方 - TASK NOTES</a>
</p>
<ul class="org-ul">
<li>前半はMacOSX用の記述ですが，rbenvインストール後は，そのまま使え
ます。
</li>
</ul>

<div class="org-src-container">

<pre class="src src-sh"># [~/]
rbenv install --list  # インストール可な ruby を表示
</pre>
</div>

<p>
最新の安定版を入れましょう:
</p>

<div class="org-src-container">

<pre class="src src-sh">rbenv install 2.3-dev #
rbenv global 2.3-dev  # 
rbenv init            # シェルの設定
</pre>
</div>

<p>
インストールされたことを確かめましょう:
</p>

<div class="org-src-container">

<pre class="src src-sh">which ruby # ruby インタプリター
which gem  # ruby パッケージ管理コマンド
which irb  # 対話型 ruby インタプリター
</pre>
</div>

<p>
.bashrc に下記のコマンドを付け加えましょう:
</p>

<div class="org-src-container">

<pre class="src src-sh">eval "$(rbenv init -)"
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-1-3" class="outline-4">
<h4 id="sec-3-1-3">gem &#x2013; ruby のパッケージ管理</h4>
<div class="outline-text-4" id="text-3-1-3">
<p>
<a href="https://allabout.co.jp/gm/gc/439246/3/">RubyGems (gem) の使い方・インストール方法</a>
</p>

<p>
gemを使ってパッケージをいれてみましょう:
</p>

<div class="org-src-container">

<pre class="src src-sh">gem install pry
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-1-4" class="outline-4">
<h4 id="sec-3-1-4">bundler</h4>
<div class="outline-text-4" id="text-3-1-4">
<p>
この講義では使いませんが，一応紹介です:
</p>
<ul class="org-ul">
<li><a href="https://blog.tokoyax.com/entry/ruby/bundler">Ruby の gem をプロジェクト毎に Bundler で管理する - fugafuga.write()</a>
</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> pry</h3>
<div class="outline-text-3" id="text-3-2">
<p>
pry は irb に替わる対話型インタプリタです。デバッガとして使えます。
</p>

<ul class="org-ul">
<li>Ruby - 今更聞けないpryの使い方と便利プラグイン集 - Qiita
<a href="https://qiita.com/k0kubun/items/b118e9ccaef8707c4d9f">https://qiita.com/k0kubun/items/b118e9ccaef8707c4d9f</a>
</li>

<li>第3回　Pry ～IRBをより見やすく、より便利に～
<a href="https://www.school.ctc-g.co.jp/columns/masuidrive/masuidrive03.html">https://www.school.ctc-g.co.jp/columns/masuidrive/masuidrive03.html</a>
</li>

<li>Rubyistよ、irbを捨ててPryを使おう - TIM Labs
<a href="https://labs.timedia.co.jp/2011/12/rubyist-should-use-pry.html">https://labs.timedia.co.jp/2011/12/rubyist-should-use-pry.html</a>
</li>

<li>Emacs×Ruby - PryをEmacsで使ってみる - <a href="https://rubikitch.com/%E3%81%AB%E7%A7%BB%E8%BB%A2%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F">https://rubikitch.com/%E3%81%AB%E7%A7%BB%E8%BB%A2%E3%81%97%E3%81%BE%E3%81%97%E3%81%9F</a>
      <a href="https://d.hatena.ne.jp/rubikitch/20140627/pry">https://d.hatena.ne.jp/rubikitch/20140627/pry</a>

<ul class="org-ul">
<li>emacs で run-ruby で pry が動きだし，いろいろ便利に使えます。
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>




<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> ruby におけるプログラムの実行のまとめ</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> プログラム</h3>
<div class="outline-text-3" id="text-4-1">
</div><div id="outline-container-sec-4-1-1" class="outline-4">
<h4 id="sec-4-1-1">self とクラス</h4>
<div class="outline-text-4" id="text-4-1-1">
<ul class="org-ul">
<li>自分 (self) は，あるクラスから生まれたオブジェクトである
</li>
<li>自分 (self) は，コード (ブロック) を実行する
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-4-1-2" class="outline-4">
<h4 id="sec-4-1-2">リテラル</h4>
<div class="outline-text-4" id="text-4-1-2">
<p>
オブジェクトを表す文字列．そのオブジェクトが評価値．
</p>
</div>
</div>

<div id="outline-container-sec-4-1-3" class="outline-4">
<h4 id="sec-4-1-3">変数</h4>
<div class="outline-text-4" id="text-4-1-3">
<p>
オブジェクトの名前，
束縛を持ち，その値が評価値
</p>

<ul class="org-ul">
<li>ブロックが持つブロックローカル変数
</li>
<li>オブジェクトがもつインスタンス変数
</li>
<li>クラスが持つクラス変数，定数
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-4-1-4" class="outline-4">
<h4 id="sec-4-1-4">メッセージパッシング式</h4>
<div class="outline-text-4" id="text-4-1-4">
<p>
obj.msg(*args)
</p>
<ul class="org-ul">
<li>オブジェクト obj に文字列 msg とオブジェクト列を(引数として)渡す
</li>
<li>msg は操作を表し、その意味は obj によって決まる
</li>
<li>obj が組み込みオブジェクトになると計算され結果のオブジェクトとな
る
</li>
<li>評価値は上記を再帰的に行うことで計算される
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-4-1-5" class="outline-4">
<h4 id="sec-4-1-5">メソッドとクラス</h4>
<div class="outline-text-4" id="text-4-1-5">
<p>
メソッドはクラスに属し，
クラスは継承でき，
継承したクラスのメソッドも利用できる
</p>
</div>
</div>

<div id="outline-container-sec-4-1-6" class="outline-4">
<h4 id="sec-4-1-6">文と制御</h4>
</div>


<div id="outline-container-sec-4-1-7" class="outline-4">
<h4 id="sec-4-1-7">スコープの切り替え</h4>
<div class="outline-text-4" id="text-4-1-7">
<pre class="example">
class C end
def m() end
{ ... } 
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> rubyあれこれ</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> オブジェクトとメソッド呼び出し</h3>
<div class="outline-text-3" id="text-5-1">
<p>
メソッド呼び出しができるのは実体 (<b>オブジェクト</b>)中のブロック
</p>

<p>
オブジェクト中の実行の場 (ブロック) は二ヶ所
</p>
<ul class="org-ul">
<li>self のトップレベルブロック
</li>
<li>実行中のメソッドブロック
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2"><span class="section-number-3">5.2</span> String.newで起こること</h3>
<div class="outline-text-3" id="text-5-2">
<p>
Class
</p>
<ul class="org-ul">
<li>Class オブジェクトだけは，オブジェクトを生み出せる (特異) new メソッドをもつ
</li>
<li>Class オブジェクトは，継承できる
</li>
<li>Class オブジェクトを，継承したオブジェクトをクラスとする
</li>
<li>Class はクラスである
</li>
</ul>

<p>
String は Class を継承して生まれているので，new メソッドが実行できる
</p>

<p>
String オブジェクトが new を実行する
</p>
<ul class="org-ul">
<li>String クラスのインスタンスを生成し，selfとする
</li>
<li>self.initialize を実行する
</li>
<li>self を返す
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3"><span class="section-number-3">5.3</span> オブジェクトとクラスとモジュール</h3>
<div class="outline-text-3" id="text-5-3">
</div><div id="outline-container-sec-5-3-1" class="outline-4">
<h4 id="sec-5-3-1">オブジェクト</h4>
<div class="outline-text-4" id="text-5-3-1">
<ul class="org-ul">
<li>メッセージのレシーバとなり，メソッドの実行ができる
</li>
<li>独自の状態を持てる
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-5-3-2" class="outline-4">
<h4 id="sec-5-3-2">モジュール &lt; オブジェクト</h4>
<div class="outline-text-4" id="text-5-3-2">
<ul class="org-ul">
<li>独自の名前空間を持つ 名前の定義
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-5-3-3" class="outline-4">
<h4 id="sec-5-3-3">クラス &lt; モジュール</h4>
<div class="outline-text-4" id="text-5-3-3">
<ul class="org-ul">
<li>オブジェクトの性質を継承 (レシーバ)
</li>
<li>モジュールの性質を継承 (名前空間)
</li>
<li>クラスに特有なメソッドを持つ (オブジェクトの生成，子クラスの生成)
</li>
</ul>

<p>
[1,2,3].each { return 1} 
</p>

<p>
[1,2,3].each { break }
</p>

<p>
def m
  [1,2,3].each { return 1} 
end
</p>

<p>
def m 
  [1,2,3].each { break }
end
</p>
</div>
</div>
</div>

<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4"><span class="section-number-3">5.4</span> クロージャ</h3>
<div class="outline-text-3" id="text-5-4">
<dl class="org-dl">
<dt> クロージャ </dt><dd>コードと環境の組み
<dl class="org-dl">
<dt> コード </dt><dd>名前を使った一連の操作
</dd>
<dt> 環境 </dt><dd>名前に対して値を与える
</dd>
<dt> 名前 </dt><dd>メソッド名，局所変数，インスタンス変数、クラス変数、グ
ローバル変数, 定数
</dd>
</dl>
</dd>
</dl>

<p>
self, class, module構造 はクロージャには閉じこめられない？
</p>
</div>
</div>

<div id="outline-container-sec-5-5" class="outline-3">
<h3 id="sec-5-5"><span class="section-number-3">5.5</span> フレーム</h3>
<div class="outline-text-3" id="text-5-5">
<ul class="org-ul">
<li>メソッド呼び出しを実行する環境
</li>
<li>ブロックはフレーム内で実行される（と思う）
</li>
<li>Procとlambda で，違うのは所属するフレーム
</li>
</ul>
</div>
</div>
</div>



<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> rubyは生産性が高い？</h2>
<div class="outline-text-2" id="text-6">
<ul class="org-ul">
<li>ruby を仕事で使おう <a href="https://itpro.nikkeibp.co.jp/article/COLUMN/20060921/248715/">https://itpro.nikkeibp.co.jp/article/COLUMN/20060921/248715/</a>
</li>

<li>上記記事への批評
<a href="https://d.hatena.ne.jp/fromdusktildawn/20061002/1159784863">https://d.hatena.ne.jp/fromdusktildawn/20061002/1159784863</a>

<p>
上記記事への ((s-:)) の考え
</p>

<ul class="org-ul">
<li>できるかどうかじゃなくて，そのやり方の「抽象化」が問題なんだよ
ね．原則が問題となる．原則がメタのやり方の源．
</li>

<li>Scheme なら原則はシンプルで，何でもできる．が，自由すぎるのが問題
視される．僕は好きだけど．
</li>

<li>Ruby の原則もシンプル．オブジェクト指向の枠組みの中で自由さが得
られる純粋で少ない原則を持つ．
</li>

<li>Scheme のRS で言っている，少ない原則で無限の拡張性を得ること．
それがメタプログラミングの原則．
</li>

<li>メタプログラミングのやり方は，言語の原則で決まる．
じゃ，メタメタプログラミングは？ リフレクティブな手法のすべては，
結局言語の原則に依る．
</li>

<li>手続き型言語で最もシンプルな原則の言語は，Scheme.
</li>

<li>手続き型言語にオブジェクト指向原則を入れて最もシンプルな原則を
持つ言語が，Ruby. (だと信じている）
</li>

<li>ちょっと毛色が変わるけど，実行プロセスが扱えるかと言うのもメタで
本質的．対象とできるかということ．言語レベルとは違うメタレベルを
手に入れられる．

<p>
これに関しては，Scheme が最もシンプルでキレイ．
</p>

<p>
Ruby はオブジェクト指向の枠組みで，最もシンプルでキレイ（と信ず
る）．
</p>
</li>
</ul>
</li>

<li>IPA java
<a href="https://www.ipa.go.jp/software/open/ossc/download/Model_Curriculum_E1_Guidance_4_1_1.pdf">https://www.ipa.go.jp/software/open/ossc/download/Model_Curriculum_E1_Guidance_4_1_1.pdf</a> 
</li>
</ul>
</div>

<div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1"><span class="section-number-3">6.1</span> 語彙 メタプログラミング</h3>
<div class="outline-text-3" id="text-6-1">
<ul class="org-ul">
<li><a href="https://ja.wikipedia.org/wiki/%E3%83%A1%E3%82%BF%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0">https://ja.wikipedia.org/wiki/%E3%83%A1%E3%82%BF%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0</a>
</li>
<li>メタプログラミングの光と影 <a href="https://d.hatena.ne.jp/higayasuo/20090208/1234058491">https://d.hatena.ne.jp/higayasuo/20090208/1234058491</a>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> pry</h2>
<div class="outline-text-2" id="text-7">
</div><div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1"><span class="section-number-3">7.1</span> what is pry?</h3>
<div class="outline-text-3" id="text-7-1">
<dl class="org-dl">
<dt> what </dt><dd>irbの代替，デバッグ
</dd>
<dt> links </dt><dd><ul class="org-ul">
<li><a href="https://labs.timedia.co.jp/2011/12/rubyist-should-use-pry.html">Rubyistよ、irbを捨ててPryを使おう - TIM Labs</a>
</li>
<li><a href="https://github.com/pry/pry/wiki">pry Wiki</a>
</li>
<li><a href="https://railscasts.com/episodes/280-pry-with-rails">#280 Pry with Rails - RailsCasts</a>
</li>
</ul>
</dd>
</dl>
</div>
</div>


<div id="outline-container-sec-7-2" class="outline-3">
<h3 id="sec-7-2"><span class="section-number-3">7.2</span> Rubyistよ、irbを捨ててPryを使おう</h3>
<div class="outline-text-3" id="text-7-2">
<p>
<a href="https://labs.timedia.co.jp/2011/12/rubyist-should-use-pry.html">https://labs.timedia.co.jp/2011/12/rubyist-should-use-pry.html</a>
</p>
</div>
<div id="outline-container-sec-7-2-1" class="outline-4">
<h4 id="sec-7-2-1">起動</h4>
<div class="outline-text-4" id="text-7-2-1">
<pre class="example">
$ pry
[1] pry(main)&gt;
[2] pry(main)&gt; -&gt;n{ i=0;j=1;n.times{j=i+i=j};i }.call(10)
=&gt; 55
[3] pry(main)&gt; def foo
[3] pry(main)*   ^
</pre>
</div>
</div>

<div id="outline-container-sec-7-2-2" class="outline-4">
<h4 id="sec-7-2-2">shellとの統合</h4>
<div class="outline-text-4" id="text-7-2-2">
<p>
Pryはshellと統合し、shellのコマンドをPryコンソール上で実行できます。
ただ、コマンドの前に'.'を付けて実行します。
</p>

<pre class="example">
[1] pry(main)&gt; .ls
[2] pry(main)&gt; .pwd
[3] pry(main)&gt; .git log --pretty=oneline
[4] pry(main)&gt; x = "class Hoge"
[5] pry(main)&gt; .find . -name "*.rb" | xargs grep #{x}
</pre>

<p>
組み込みコマンドのshell-modeを使うと、
</p>
<ul class="org-ul">
<li>プロンプトにカレントディレクトリが表示され、
</li>
<li>tabキーでディレクトリ名を補完できるようになり、
</li>
<li>よりファイル操作が簡単になります。
</li>
</ul>

<pre class="example">
[6] pry(main)&gt; shell-mode
pry main:/Users/yoppi $ shell-mode
[8] pry(main)&gt;
</pre>

<p>
shell-modeを抜けるには、再度shell-modeコマンドを実行します。
</p>
</div>
</div>

<div id="outline-container-sec-7-2-3" class="outline-4">
<h4 id="sec-7-2-3">組み込みコマンド</h4>
<div class="outline-text-4" id="text-7-2-3">
<pre class="example">
[1] pry(main)&gt; help
</pre>

<p>
以下に便利な組み込みコマンドの一部を紹介します。
</p>

<dl class="org-dl">
<dt> hist </dt><dd>Pryコンソールで評価した過去の式の一覧を確認できます
</dd>
<dt> ls </dt><dd>現在のフレームで有効なオブジェクトを表示します。'デバッガとして使う'で詳しく紹介します
</dd>
<dt> gem-install、gem-list </dt><dd>Pryコンソール上でgemをインストールしたり、gemの一覧を確認できます
</dd>
<dt> gist-method </dt><dd>gemのgistをさらにラップしたものが使えます
</dd>
<dt> shell-mode </dt><dd>Pryからシームレスにファイルにアクセスでき、Pryからファイルを操作したい場合はshell-modeになると便利です
</dd>
<dt> ! </dt><dd>Pryで評価しているフレームをリセットします
</dd>
<dt> ri </dt><dd>riコマンドをPry上で実行します
</dd>
<dt> show-doc </dt><dd>対象メソッドのドキュメントを表示します
</dd>
<dt> show-method </dt><dd>対象メソッドの実装表示します
</dd>
</dl>
</div>
</div>

<div id="outline-container-sec-7-2-4" class="outline-4">
<h4 id="sec-7-2-4">オブジェクトを調査する</h4>
<div class="outline-text-4" id="text-7-2-4">
<p>
Pry独自の概念として、オブジェクト間を移動できます。 デバッガのフレー
ムに似ています。 lsコマンドで現在のオブジェクトの一覧を表示し、cdコ
マンドでそのオブジェクトに移動できます。
</p>

<pre class="example">
[1] pry(main)&gt; a = "foo"
[2] pry(main)&gt; ls
locals: _  _dir_  _ex_  _file_  _in_  _out_  _pry_  a  version
[3] pry(main)&gt; cd a
[4] pry("foo"):1&gt; nesting
Nesting status:
--
0. main (Pry top level)
1. "foo"
[5] pry("foo"):1&gt; ls
Comparable methods: &lt; &lt;= &gt; &gt;= between?
String methods: ... 
[6] pry("foo"):1&gt; upcase
=&gt; "FOO"
</pre>

<p>
深くネストしたオブジェクトの調査もcdして潜っていける
</p>
</div>
</div>

<div id="outline-container-sec-7-2-5" class="outline-4">
<h4 id="sec-7-2-5">簡易デバッガとして使う</h4>
<div class="outline-text-4" id="text-7-2-5">
<p>
適当な箇所に次のコードを差し込みましょう。
</p>

<pre class="example">
binding.pry
binding.pry if expression
</pre>

<p>
ここがブレークポイントになり、Pryコンソールが立ち上がりま
す。 
</p>

<p>
停止した時点で評価されたオブジェクトにアクセスできるので、デバッグを
自由に進められます。 ステップ実行したければ、binding.pryを停止させた
い箇所に埋め込みましょう。 
</p>

<p>
普通のRubyアプリケーションであれば、edit-methodコマンドで現在のメソッ
ド名を指定することでそのメソッドを編集でき、また、直接エディタで編集
した場合reload-methodで読み込みなおすとstep実行できます。
</p>
</div>
</div>
</div>

<div id="outline-container-sec-7-3" class="outline-3">
<h3 id="sec-7-3"><span class="section-number-3">7.3</span> ドキュメントに素早く参照できる</h3>
<div class="outline-text-3" id="text-7-3">
<p>
show-method、stat等のコマンドが用意されています。 また、シェル経由で
riコマンドをそのまま使用できます。 VimやEmacs使い達は、それぞれのエ
ディタ上で素早くドキュメントを牽けるようにしているはずですが、irbで
作業しているときには牽けません。 Pryではこれらの組み込みコマンドが提
供されていることで、素早くドキュメントにアクセスできます
</p>

<pre class="example">
[1] pry(main)&gt; ri Array#sample
[2] pry(main)&gt; require 'pathname'
[3] pry(main)&gt; show-doc Pathname#children
</pre>
</div>


<div id="outline-container-sec-7-3-1" class="outline-4">
<h4 id="sec-7-3-1">gemやCの実装も読める</h4>
<div class="outline-text-4" id="text-7-3-1">
<p>
さて、Rubyのオブジェクトに対してメソッドを呼び出すわけですが、そのオ
ブジェクトがどう実装されているか気になるときがあります。 特に、gemラ
イブラリを使っているときに、APIがどんなことをしているのか素早く知り
たいわけです。
</p>

<pre class="example">
[4] pry(main)&gt; require 'nokogiri'
[5] pry(main)&gt; show-method Nokogiri::HTML::Document.parse
From: /Users/yoppi/opt/local/ruby/ruby-1.9.3-p0/lib/ruby/gems/1.9.1/gems/nokogiri-1.4.4/lib/nokogiri/html/document.rb @ line 64:
Number of lines: 22
Owner: #&lt;Class:Nokogiri::HTML::Document&gt;
Visibility: public

def parse string_or_io, url = nil, encoding = nil, options = XML::ParseOptions::DEFAULT_HTML
...
</pre>

<p>
また、Rubyの組み込みライブラリはCで実装されています。 よくRubyiest達
はCで実装しているコードを眺めて、実装を楽しんだり、もっと改善できる
ところはなかな? と考えるときがあります。 Pryなら簡単に該当する組み込
みライブラリのCのコードを読めます。 Cのコードを読むには、pry-docをイ
ンストールしておく必要があります。 たとえば、Array#sampleは同様に
</p>

<pre class="example">
[6] pry(main)&gt; show-method Array#sample
static VALUE
rb_ary_sample(int argc, VALUE *argv, VALUE ary)
{
    VALUE nv, result, *ptr;
    long n, len, i, j, k, idx[10];
...
</pre>

<p>
と、show-methodコマンドで牽くだけです。 これでC実装を素早く読めるの
で今まで実装を読まなかった人も読むようになり、Rubyの開発も活発になり
そうです。 大変便利ですね。
</p>
</div>
</div>
</div>


<div id="outline-container-sec-7-4" class="outline-3">
<h3 id="sec-7-4"><span class="section-number-3">7.4</span> <a href="https://github.com/pry/pry">https://github.com/pry/pry</a></h3>
<div class="outline-text-3" id="text-7-4">
</div><div id="outline-container-sec-7-4-1" class="outline-4">
<h4 id="sec-7-4-1">ls - change scope</h4>
<div class="outline-text-4" id="text-7-4-1">
<pre class="example">
ls [-m|-M|-p|-pM] [-q|-v] [-c|-i] [Object]
ls [-g] [-l]
</pre>

<pre class="example">
-m, --methods        Show public methods defined on the Object (default)
-M, --module         Show methods defined in a Module or Class
-p, --ppp            Show public, protected (in yellow) and private (in green) methods
-q, --quiet          Show only methods defined on object.singleton_class and object.class
-v, --verbose        Show methods and constants on all super-classes (ignores Pry.config.ls.ceiling)
-g, --globals        Show global variables, including those builtin to Ruby (in cyan)
-l, --locals         Show locals, including those provided by Pry (in red)
-c, --constants      Show constants, highlighting classes (in blue), and exceptions (in purple)
-i, --ivars          Show instance variables (in blue) and class variables (in bright blue)
-G, --grep           Filter output by regular expression
-h, --help           Show help
</pre>
</div>
</div>

<div id="outline-container-sec-7-4-2" class="outline-4">
<h4 id="sec-7-4-2">find-method</h4>
</div>
<div id="outline-container-sec-7-4-3" class="outline-4">
<h4 id="sec-7-4-3">nesting &#x2013; seeing the nested context</h4>
</div>
<div id="outline-container-sec-7-4-4" class="outline-4">
<h4 id="sec-7-4-4">jump-to</h4>
</div>

<div id="outline-container-sec-7-4-5" class="outline-4">
<h4 id="sec-7-4-5">switch-to</h4>
</div>
</div>


<div id="outline-container-sec-7-5" class="outline-3">
<h3 id="sec-7-5"><span class="section-number-3">7.5</span> 今更聞けないpryの使い方と便利プラグイン集</h3>
<div class="outline-text-3" id="text-7-5">
</div><div id="outline-container-sec-7-5-1" class="outline-4">
<h4 id="sec-7-5-1">info</h4>
<div class="outline-text-4" id="text-7-5-1">
<p>
site: <a href="https://qiita.com/k0kubun/items/b118e9ccaef8707c4d9f">Ruby - 今更聞けないpryの使い方と便利プラグイン集 - Qiita</a>
</p>

<p>
linked_from: <a href="https://qiita.com/tags/pry">pryに関する73件の投稿 - Qiita</a>
</p>

<ul class="org-ul">
<li>pryが何であるかが書かれていない

<p>
Ruby のデバッガ  
</p>
</li>
</ul>

<p>
meta-ruby講義での，pryの実践的な紹介のため
</p>
</div>
</div>


<div id="outline-container-sec-7-5-2" class="outline-4">
<h4 id="sec-7-5-2">最低限の使い方</h4>
<div class="outline-text-4" id="text-7-5-2">
<p>
まだpryを使ったことがない人はこれだけ知ってれば十分な気がする。
</p>
</div>

<div id="outline-container-sec-7-5-2-1" class="outline-5">
<h5 id="sec-7-5-2-1">binding.pryで任意の場所からREPLを立ち上げる</h5>
<div class="outline-text-5" id="text-7-5-2-1">
<p>
ソースの任意の箇所にbinding.pryを書いてRubyのプログラムを走らせると、実行中にその行でストップしてpryのREPLが立
ち上がり、その環境での変数がどうなっているかなどが参照できる。
アプリが原因不明のエラーを出している時、落ちている直前にbinding.pryを挟んで原因を調査したり、テストが落ちている原
因の特定などに便利。
</p>
</div>
</div>
</div>

<div id="outline-container-sec-7-5-3" class="outline-4">
<h4 id="sec-7-5-3">pry標準の機能</h4>
<div class="outline-text-4" id="text-7-5-3">
<p>
pryの便利な機能をよく使いそうな順に紹介する。
</p>
</div>

<div id="outline-container-sec-7-5-3-1" class="outline-5">
<h5 id="sec-7-5-3-1">?, show-doc, ri, $, show-method</h5>
<div class="outline-text-5" id="text-7-5-3-1">
<p>
?やshow-docを使うとドキュメントやソースコードを見ることができる。
</p>

<p>
riはriコマンドを実行する。
</p>

<p>
$やshow-methodを使うとメソッドの定義を見ることができる。
</p>
</div>
</div>

<div id="outline-container-sec-7-5-3-2" class="outline-5">
<h5 id="sec-7-5-3-2">edit</h5>
<div class="outline-text-5" id="text-7-5-3-2">
<p>
今はまだどこにソースがあるかがわからないところにbinding.pryを貼りたいことがある。
editを使うとpryで定義場所を調べたあとエディタでそれを開くみたいなコストが減らせる。
あとは周辺をそのまま読みたいときにも便利。
</p>

<p>
エディタは$EDITORをいじるか.pryrcにPry.editor = 'vim'とか書けば変えられる。
</p>
</div>
</div>

<div id="outline-container-sec-7-5-3-3" class="outline-5">
<h5 id="sec-7-5-3-3">cd, ls, Tab補完</h5>
<div class="outline-text-5" id="text-7-5-3-3">
<p>
pryも普通のシェルと同じようにcd, lsやタブキーによる補完がある。
cdを使うとコンテキストを移動できる。上の画像ではmainからAcitveRecord::RelationやArelの内側に入っている。
</p>

<p>
lsは現在のコンテキストにおけるメソッドや変数の一覧が見れる。
メソッドの一覧だけ見たいときはls -m。ls &#x2013;grepで絞込ができる。
</p>
</div>
</div>

<div id="outline-container-sec-7-5-3-4" class="outline-5">
<h5 id="sec-7-5-3-4">exit!, !!!, exit-program, disable-pry, edit -m</h5>
<div class="outline-text-5" id="text-7-5-3-4">
<p>
何度も呼ばれるメソッドやループの内側にbinding.pryを書いて何度もブレークして困った事がある人は多いと思う。
一番楽で乱暴な方法はexit!, !!!, exit-programでプロセスを終了してしまうことである。でもこれだと例えばrails s上でやると
rails sが落ちる。
disable-pryは以降pryが完全に無効になるのでプロセスは死なないけど、以降binding.pryが使えなくなる。
</p>

<p>
多分一番健全な方法は、ちょっと面倒だけどedit -mで現在のメソッドからbinding.pryを取り除くことだと思う。
</p>
</div>
</div>

<div id="outline-container-sec-7-5-3-5" class="outline-5">
<h5 id="sec-7-5-3-5">.とshell-mode</h5>
<div class="outline-text-5" id="text-7-5-3-5">
<p>
「.」で始めると以降をシェルのコマンド入力として受け付ける。画像のように#{}の式展開が使える。
shell-modeを使うとカレントディレクトリを表示してくれるのと、ファイル名補完が有効になる。
</p>
</div>
</div>

<div id="outline-container-sec-7-5-3-6" class="outline-5">
<h5 id="sec-7-5-3-6">help</h5>
<div class="outline-text-5" id="text-7-5-3-6">
<p>
単にRubyの式を評価するだけでなく、pryには独自のコマンドが存在する。その全リストをhelpコマンドで確認することがで
きる。
セクションごとに分けて表示してくれるので、例えばpry-railsプラグイン特有の機能のリストを見たいときなどに役に立つ。
</p>

<p>
各コマンドは-h(&#x2013;help)をつけると使い方を見ることができる。
余力がある人はhist, find-method, whereami(@), nesting あたりは見ておくと良いと思う。
</p>
</div>
</div>
</div>


<div id="outline-container-sec-7-5-4" class="outline-4">
<h4 id="sec-7-5-4">便利なプラグイン (<a href="https://rubygems.org/search?utf8=%E2%9C%93&query=pry-">pry関連プラグイン</a>)</h4>
<div class="outline-text-4" id="text-7-5-4">
<p>
個人的には以下の3つだけ知ってれば十分だと思う
</p>
</div>

<div id="outline-container-sec-7-5-4-1" class="outline-5">
<h5 id="sec-7-5-4-1">pry-byebug</h5>
<div class="outline-text-5" id="text-7-5-4-1">
<p>
古代のRuby向けに作られたpry-navとpry-debuggerの後継がpry-byebug。
ステップ実行など、デバッガとしてちゃんとpryを使いたい場合はこれが必要になる。
</p>

<p>
以下のコマンドだけ覚えておけば良い。
</p>

<p>
コマンド  操作    
step  メソッドの内部に入る    
next  現在のメソッド内で1行進める    
finish  現在のメソッドを抜ける    
continue  デバッグを抜ける    
</p>
</div>
</div>

<div id="outline-container-sec-7-5-4-2" class="outline-5">
<h5 id="sec-7-5-4-2">pry-stack_explorer</h5>
<div class="outline-text-5" id="text-7-5-4-2">
<p>
show-stackしてスタックのリストを出しframe [数字]とやると任意のスタックにコンテキストを移動できる。
</p>
</div>
</div>

<div id="outline-container-sec-7-5-4-3" class="outline-5">
<h5 id="sec-7-5-4-3">pry-rails</h5>
<div class="outline-text-5" id="text-7-5-4-3">
<p>
rails cを置き換えるのがメインで、いくつかは機能がrake taskとかぶっている。
それでも一応使いそうなのを紹介しておく。
</p>
</div>

<div id="outline-container-sec-7-5-4-3-0-0-1" class="outline-8">
<h8 id="sec-7-5-4-3-0-0-1">show-routes</h8>
<div class="outline-text-8" id="text-7-5-4-3-0-0-1">
<p>
とにかく実行がめちゃくちゃ速い。spring rake routesより速いので良い。-G(&#x2013;grep)で絞り込む。
単にパスがどう引っかかるか調べたいときはrecognize-pathを使う。
</p>
</div>
</div>

<div id="outline-container-sec-7-5-4-3-0-0-2" class="outline-8">
<h8 id="sec-7-5-4-3-0-0-2">show-model, show-models</h8>
<div class="outline-text-8" id="text-7-5-4-3-0-0-2">
<p>
schema.rbとかを開かなくてもスキーマが確認できるので便利。
show-modelsを使うと全部表示される。
</p>
</div>
</div>

<div id="outline-container-sec-7-5-4-3-0-0-3" class="outline-8">
<h8 id="sec-7-5-4-3-0-0-3">reload!</h8>
<div class="outline-text-8" id="text-7-5-4-3-0-0-3">
<p>
rails cを再起動しなくて済む。
</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: suzuki@cis.iwate-u.ac.jp</p>
<p class="date">Created: 2016-10-02 日 21:54</p>
<p class="creator"><a href="https://www.gnu.org/software/emacs/">Emacs</a> 24.5.1 (<a href="https://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
